(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/person/reg"],{"12f8":function(e,t,o){"use strict";var n=function(){var e=this,t=e.$createElement;e._self._c},i=[];o.d(t,"a",function(){return n}),o.d(t,"b",function(){return i})},"1ab4":function(e,t,o){"use strict";(function(e){o("8ad5"),o("921b");n(o("66fd"));var t=n(o("c225"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("543d")["createPage"])},"4f8c":function(e,t,o){"use strict";var n=o("af22"),i=o.n(n);i.a},8397:function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(o("0e8f")),i=o("2f62");function a(e){return e&&e.__esModule?e:{default:e}}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{},n=Object.keys(o);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(o).filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable}))),n.forEach(function(t){r(e,t,o[t])})}return e}function r(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var c={components:{},data:function(){return{loginMode:1,usernameType:"text",codeBut:"获取验证码",codeClick:!0,mobile:"",password:"",repassword:"",code:"",backpage:"../index/home",Code:"",SessionKey:"",OpenId:"",bindmobile:!1,vcode:""}},computed:(0,i.mapState)(["forcedLogin"]),methods:s({},(0,i.mapMutations)(["login"]),{showModal:function(){this.bindmobile=!0},hideModal:function(e){this.bindmobile=!1},mobileInput:function(e){this.mobile=e.detail.value},passwordInpur:function(e){this.password=e.detail.value},repasswordInpur:function(e){this.repassword=e.detail.value},codeInput:function(e){this.code=e.detail.value},getCode:function(){var e=this;e.codeClick&&(/(^1[3|4|5|7|8][0-9]{9}$)/.test(e.mobile)?(e.codeClick=!1,e._sendmsm(e.mobile)):this.$api.msg("请输入正确的手机号"))},regUp:function(){var e=this;if(""!=e.mobile)if(/(^1[3|4|5|7|8][0-9]{9}$)/.test(e.mobile))if(""!=e.password)if(e.repassword==e.password)if(""!=e.code){var t={mobile:e.mobile,password:e.password,repassword:e.repassword,code:e.code,vcode:e.vcode};this._regrequest(t)}else this.$api.msg("请输入验证码");else this.$api.msg("两次密码输入不一致");else this.$api.msg("请输入密码");else this.$api.msg("手机号码格式不正确");else this.$api.msg("请输入手机号码")},_regrequest:function(t){var o=this,i=this,a={url:"/userApi/reg/",method:"post"},s=t;n.default.httpRequest(a,s).then(function(t){0==t.data["code"]?(i.login(t.data["token"]),e.navigateTo({url:o.backpage})):o.$api.msg(t.data.msg)},function(e){console.log(e)})},_sendmsm:function(t){var o=this,i=this,a={url:"/CommonApi/sendmsm/",method:"post"},s={mobile:t,sendtype:"reg"};n.default.httpRequest(a,s).then(function(e){if(0==e.data["code"])var t=60,n=setInterval(function(){i.codeBut="重新发送"+t,t--,t<=0&&(i.codeBut="重新发送",i.codeClick=!0,clearInterval(n))},1e3);else o.$api.msg(e.data.msg)},function(t){console.log(t),e.showModal({content:err.errMsg,showCancel:!1})},function(e){o.loading=!1})},getPhoneNumberHander:function(e){var t=this;console.log("e",e);var o=this;if("getPhoneNumber:fail user deny"==e.detail.errMsg)wx.showModal({title:"提示",showCancel:!1,content:"未授权您将无法登陆",success:function(e){}});else{var i={url:"/CommonApi/getphone/",method:"post"},a={encryptedData:e.detail.encryptedData,iv:e.detail.iv,session_key:this.SessionKey};n.default.httpRequest(i,a).then(function(e){0==e.data["code"]?(o.weixinreg(e.data["phone"]),console.log(e.data)):t.$api.msg(e.data.msg)},function(e){console.log(e)})}},weixinreg:function(t){var o=this,i=this,a={url:"/UserApi/wxreg/",method:"post"},s={mobile:t,wxopenid:this.OpenId,nickname:this.userinfo["nickName"],province:this.userinfo["province"],city:this.userinfo["city"],country:this.userinfo["country"],gender:this.userinfo["gender"],vcode:i.vcode};n.default.httpRequest(a,s).then(function(t){0==t.data["code"]?""!=t.data["token"]&&(i.login(t.data["token"]),e.navigateTo({url:i.backpage})):o.$api.msg(t.data.msg)},function(e){console.log(e)})},weixinlogin:function(){var t=this;e.showLoading({title:"登录中..."}),e.getProvider({service:"oauth",success:function(o){~o.provider.indexOf("weixin")&&e.login({provider:"weixin",success:function(o){var i=this,a=o.code;console.log(o),e.getUserInfo({provider:"weixin",success:function(e){console.log(e.userInfo);var o=e.userInfo;t.userinfo=o}});var s={url:"/CommonApi/getwxopenid/",method:"post"},r={code:a};t.Code=a,n.default.httpRequest(s,r).then(function(o){if(0==o.data["code"]){if(""!=o.data["token"])t.login(o.data["token"]),e.navigateTo({url:t.backpage});else{var n=o.data["data"].session_key,a=o.data["data"].openid;t.OpenId=a,t.SessionKey=n,t.showModal()}e.hideLoading()}else i.$api.msg(o.data.msg)},function(e){console.log(e)})}})}})}}),onReady:function(){},onLoad:function(t){"undefined"!=t.backurl&&(this.backpage=decodeURIComponent(t.backurl));try{var o=e.getStorageSync("vcode");o&&(this.vcode=o)}catch(n){}}};t.default=c}).call(this,o("543d")["default"])},af22:function(e,t,o){},c225:function(e,t,o){"use strict";o.r(t);var n=o("12f8"),i=o("d440");for(var a in i)"default"!==a&&function(e){o.d(t,e,function(){return i[e]})}(a);o("4f8c");var s=o("2877"),r=Object(s["a"])(i["default"],n["a"],n["b"],!1,null,null,null);t["default"]=r.exports},d440:function(e,t,o){"use strict";o.r(t);var n=o("8397"),i=o.n(n);for(var a in n)"default"!==a&&function(e){o.d(t,e,function(){return n[e]})}(a);t["default"]=i.a}},[["1ab4","common/runtime","common/vendor"]]]);